var domAttr=function(){var b={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},c=document.createElement("div");c.setAttribute("class","t");var a="t"===c.className;return{setAttr:function(c,e,f){c.setAttribute(a?e:b[e]||e,f)},getAttr:function(c,e){return c.getAttribute(a?e:b[e]||e)}}}(),copySwf=[],copyObject={isCopy:!1,isFlash:0,swfUrl:"copy.swf",cStyle:".copySwf{cursor:pointer;position:absolute;top:0;left:0;z-index: 10;width: 100%;height: 100%;opacity: 0;-moz-opacity: 0;filter:alpha(opacity\x3d0);overflow:hidden;}",cStyle2:".copySwf{cursor:pointer;position:absolute;top:0;left:0;z-index: 10;width: 100%;height: 100%;opacity: 0;-moz-opacity: 0;filter:alpha(opacity\x3d0);overflow:hidden;background: #000;display:block;}",copyTxt:"",copyNum:0,initCopy:function(b){var c=document.getElementById(b);if(copyObject.isCopy){var a=document.createElement("a");domAttr.setAttr(a,"class","copySwf");domAttr.setAttr(a,"href","javascript:copyObject.copyCip(copyObject.copyTxt);");c.appendChild(a)}else copyObject.isFlash?(a=document.createElement("div"),b="copySwf"+b,domAttr.setAttr(a,"class","copySwf"),a.innerHTML='\x3cobject classid\x3d"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" width\x3d"1920" height\x3d"1080" id\x3d"'+b+'"\x3e\x3cparam name\x3d"movie" value\x3d"'+copyObject.swfUrl+'"/\x3e\x3cparam name\x3d"wmode" value\x3d"transparent" /\x3e\x3cparam name\x3d"allowScriptAccess" value\x3d"always" /\x3e\x3cembed src\x3d"'+copyObject.swfUrl+'" width\x3d"1920" height\x3d"1080" name\x3d"'+b+'" wmode\x3d"transparent" allowscriptaccess\x3d"always" type\x3d"application/x-shockwave-flash" pluginspage\x3d"http://www.macromedia.com/go/getflashplayer"\x3e\x3c/object\x3e',c.appendChild(a),copySwf[copySwf.length]=thisMovie(b)):(a=document.createElement("a"),domAttr.setAttr(a,"class","copySwf"),domAttr.setAttr(a,"href","javascript:copyObject.copyCip(copyObject.copyTxt);"),c.appendChild(a))},setTxt:function(b,c){copyObject.copyTxt=b;copyObject.copyNum=c},initStyle:function(){copyObject.isCopy=copyObject.isCopyFn();copyObject.isFlash=copyObject.isFlashFn().f;var b=document.createElement("style"),c=copyObject.isCopy?copyObject.cStyle2:copyObject.isFlash?copyObject.cStyle:copyObject.cStyle2;b.type="text/css";b.styleSheet?b.styleSheet.cssText=c:b.innerHTML=c;document.getElementsByTagName("head")[0].appendChild(b)},isCopyFn:function(){if(window.clipboardData||-1!=navigator.userAgent.indexOf("Opera"))return!0;if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(d){return!1}var b=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!b)return!1;var c=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!c)return!1;c.addDataFlavor("text/unicode");var a;a=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);a.data="";c.setTransferData("text/unicode",a,0);if(!b)return!1;b.setData(c,null,Components.interfaces.nsIClipboard.kGlobalClipboard);return!0}return!1},copyCip:function(b){if(window.clipboardData)window.clipboardData.setData("Text",b),alert("\u5185\u5bb9\u5df2\u590d\u5236\u5230\u526a\u5207\u677f\uff01");else if(-1!=navigator.userAgent.indexOf("Opera"))window.location=b;else if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(e){alert("\u590d\u5236\u529f\u80fd\u88ab\u6d4f\u89c8\u5668\u62d2\u7edd\uff01\n\u8bf7\u5728\u6d4f\u89c8\u5668\u5730\u5740\u680f\u8f93\u5165'about:config'\u5e76\u56de\u8f66\n\u7136\u540e\u5c06'signed.applets.codebase_principal_support'\u8bbe\u7f6e\u4e3a'true'\n\u6216\u8005\u624b\u52a8\u590d\u5236\u76f8\u5e94\u5185\u5bb9")}var c=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(c){var a=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(a){a.addDataFlavor("text/unicode");var d;d=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);d.data=b;a.setTransferData("text/unicode",d,2*b.length);if(!c)return!1;c.setData(a,null,Components.interfaces.nsIClipboard.kGlobalClipboard);alert("\u5185\u5bb9\u5df2\u590d\u5236\u5230\u526a\u5207\u677f\uff01")}}}else alert("\u60a8\u7684\u6d4f\u89c8\u5668\u4e0d\u652f\u6301\u590d\u5236\u529f\u80fd\uff0c\u8bf7\u60a8\u624b\u52a8\u590d\u5236\uff01")},isFlashFn:function(){var b=0,c=0;if(document.all)try{var a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),b=1;VSwf=a.GetVariable("$version");c=parseInt(VSwf.split(" ")[1].split(",")[0])}catch(e){if(navigator.plugins&&0<navigator.plugins.length&&(a=navigator.plugins["Shockwave Flash"]))for(var b=1,a=a.description.split(" "),d=0;d<a.length;++d)isNaN(parseInt(a[d]))||(c=parseInt(a[d]))}else if(navigator.plugins&&0<navigator.plugins.length&&(a=navigator.plugins["Shockwave Flash"]))for(b=1,a=a.description.split(" "),d=0;d<a.length;++d)isNaN(parseInt(a[d]))||(c=parseInt(a[d]));return{f:b,v:c}}};copyObject.initStyle();function copyBegin(){copySwf[copyObject.copyNum].copySwfFn(copyObject.copyTxt)}function copySuccess(b){alert("\u5185\u5bb9\u5df2\u590d\u5236\u5230\u526a\u5207\u677f\uff01")}function thisMovie(b){return-1!=navigator.appName.indexOf("Microsoft")?window[b]:document[b]};